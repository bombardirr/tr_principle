# Проект: Профессиональное приложение для переводчиков

## Глоссарий терминов и сокращений

### Основные термины
- **TM (Translation Memory)** - База переводов, хранящая пары "исходный текст - переведенный текст"
- **CAT (Computer-Aided Translation)** - Компьютерная помощь переводчику
- **Trados** - Популярное профессиональное приложение для переводчиков (эталон для нашего проекта)
- **Сегментация** - Разбивка текста на отдельные единицы перевода (предложения, фразы, ячейки таблиц)
- **Сегмент** - Отдельная единица текста для перевода (предложение, ячейка Excel, подпись к изображению)

### Технические термины
- **GUI (Graphical User Interface)** - Графический пользовательский интерфейс
- **API (Application Programming Interface)** - Интерфейс программирования приложений
- **REST API** - Архитектурный стиль для веб-сервисов
- **WebSocket** - Протокол для двусторонней связи в реальном времени
- **ORM (Object-Relational Mapping)** - Технология программирования для связи объектно-ориентированных языков с реляционными базами данных
- **GORM** - ORM библиотека для Go
- **MVP (Minimum Viable Product)** - Минимально жизнеспособный продукт

### Типы лицензий
- **Онлайн лицензия** - Лицензия, привязанная к серверам разработчика
- **Офлайн лицензия** - Лицензия, работающая без подключения к интернету
- **Корпоративная лицензия** - Лицензия для использования внутри компании

### Типы TM (Translation Memory)
- **Личная TM** - База переводов конкретного переводчика
- **Общая TM** - База переводов, доступная команде/компании
- **Публичная TM** - База переводов, доступная всем пользователям

### Компоненты системы
- **Backend** - Серверная часть приложения
- **Frontend** - Клиентская часть приложения (интерфейс)
- **Client** - Клиентское приложение (десктоп)
- **Server** - Серверное приложение (API + база данных)

### Форматы файлов
- **DOCX** - Microsoft Word документ
- **XLSX** - Microsoft Excel таблица
- **PPTX** - Microsoft PowerPoint презентация

## Описание проекта
Разработка десктопного приложения для профессиональных переводчиков - полный аналог Trados с возможностью работы в офлайн режиме и гибкой системой лицензирования.

## Целевые платформы
- **Linux** - любой формат установки
- **macOS** - предпочтительно drag&drop в Applications или стандартная установка
- **Windows** - стандартная установка с выбором директории

## Ключевые требования
- Полноценное десктопное приложение с GUI
- **Многопользовательское приложение** - несколько переводчиков одновременно
- **Хранение переводов предложений** - личные базы переводов каждого переводчика
- **Обмен базами переводов** - возможность делиться TM с другими переводчиками
- **Автоматическая сегментация** - разбивка текста на предложения при запуске проекта
- **Умные подсказки** - процент совпадений на основе:
  - Личных баз переводчика
  - Общих баз команды/компании
  - Публичных баз (при подключении к серверам)
- Работа в офлайн режиме (без интернета)
- Гибкая система лицензирования:
  - Онлайн лицензии (привязанные к серверам)
  - Офлайн лицензии (отвязанные от серверов)
- Возможность работы с внутренними корпоративными сетями
- Продажа лицензий для корпоративного использования

## Технологический стек

### Выбранное решение: Go + Wails

**Стек:**
- Backend: Go + Wails
- Frontend: Vue.js + TypeScript
- База данных: PostgreSQL + GORM
- Сервер: Go HTTP API (для многопользовательской работы)
- Упаковка: Wails CLI
- Лицензирование: Go модули с криптографией

## Архитектура

### Многопользовательская архитектура:

#### **Вариант 1: Клиент-сервер (Рекомендуемый)**

**Сервер (Go HTTP API):**
- PostgreSQL Database (Translation Memory, Projects, Users)
- Go API Server (REST API, WebSocket, File Sync)
- License Server (User Auth, Licenses, Permissions)

**Клиенты (Go + Wails + Vue.js):**
- Desktop App 1, 2, N
- Каждый клиент: Vue.js UI + Go Backend + Local Cache
- Связь с сервером через HTTP/WebSocket

#### **Вариант 2: Гибридная архитектура**

**Центральный сервер:**
- PostgreSQL (Shared TM, Projects)
- Go API Server (Sync API, Auth API)
- License Server (User Management, License Validation)

**Локальные клиенты:**
- Desktop App (Go + Wails + Vue.js)
- Local PostgreSQL (синхронизация с центральным сервером)
- Поддержка офлайн режима

### Структура проекта:
```
project/
├── server/                 # Серверная часть
│   ├── main.go            # HTTP API сервер
│   ├── internal/          # Внутренние пакеты
│   │   ├── database/      # PostgreSQL + GORM
│   │   ├── auth/          # Аутентификация пользователей
│   │   ├── license/       # Система лицензирования
│   │   ├── translation/   # Логика переводов и TM
│   │   ├── sync/          # Синхронизация между клиентами
│   │   └── api/           # REST API endpoints
│   └── go.mod
├── client/                # Клиентская часть
│   ├── app/               # Go + Wails backend
│   │   ├── main.go        # Главный файл приложения
│   │   ├── internal/      # Внутренние пакеты
│   │   │   ├── database/  # Локальная PostgreSQL
│   │   │   ├── sync/      # Синхронизация с сервером
│   │   │   ├── license/   # Проверка лицензий
│   │   │   └── api/       # API методы для frontend
│   │   └── go.mod
│   ├── frontend/          # Vue.js frontend
│   │   ├── src/
│   │   │   ├── components/ # Vue компоненты
│   │   │   ├── views/      # Страницы приложения
│   │   │   ├── services/   # API сервисы
│   │   │   ├── types/      # TypeScript типы
│   │   │   └── main.ts     # Главный файл
│   │   ├── package.json
│   │   └── vite.config.js
│   └── wails.json
└── shared/                # Общий код
    ├── types/             # Общие типы данных
    ├── models/            # GORM модели
    └── utils/             # Общие утилиты
```

### Компоненты архитектуры:

#### Сервер (Go HTTP API):
- **main.go** - HTTP API сервер
- **database/** - PostgreSQL + GORM модели
- **auth/** - аутентификация и авторизация пользователей
- **license/** - управление лицензиями и проверка
- **translation/** - логика Translation Memory
- **sync/** - синхронизация данных между клиентами
- **api/** - REST API endpoints

#### Клиент (Go + Wails + Vue.js):
- **app/main.go** - точка входа, инициализация Wails
- **database/** - локальная PostgreSQL + GORM
- **sync/** - синхронизация с сервером
- **license/** - проверка лицензий
- **api/** - методы для вызова из frontend

#### Frontend (Vue.js + TypeScript):
- **components/** - переиспользуемые Vue компоненты
- **views/** - основные страницы приложения
- **services/** - API клиенты для связи с Go backend
- **types/** - TypeScript интерфейсы
- **utils/** - утилиты и хелперы

### База данных:
- **PostgreSQL** - центральная база для многопользовательской работы
- **Структура таблиц:**
  - `users` - пользователи системы
  - `translation_memories` - базы переводов (личные, общие, публичные)
  - `tm_permissions` - права доступа к TM (владелец, читатель, редактор)
  - `segments` - сегменты текста и переводы
  - `projects` - проекты переводов
  - `project_segments` - сегменты в проектах
  - `files` - файлы проектов
  - `tm_suggestions` - кэш подсказок для быстрого поиска
  - `settings` - настройки приложения
  - `licenses` - информация о лицензиях
  - `sync_log` - лог синхронизации между клиентами

### Система Translation Memory:

#### Типы баз переводов:
- **Личные TM** - персональные базы каждого переводчика
- **Командные TM** - общие базы команды/компании
- **Публичные TM** - базы на серверах (при подключении к лицензии)
- **Импортированные TM** - базы, полученные от других переводчиков

#### Права доступа к TM:
- **Владелец** - полный доступ (создание, редактирование, удаление, передача прав)
- **Редактор** - добавление и редактирование переводов
- **Читатель** - только просмотр и использование для подсказок

#### Система подсказок:
- **Автоматическая сегментация** - разбивка текста на предложения при создании проекта
- **Поиск совпадений** - поиск в порядке приоритета:
  1. Личные TM переводчика
  2. Командные TM
  3. Публичные TM (при подключении)
- **Процент совпадений** - точное совпадение (100%), частичное совпадение (75-99%), похожие предложения (50-74%)
- **Применение переводов:**
  - Автоматический перевод всего проекта (100% совпадения)
  - Применение переводов по отдельным предложениям
  - Редактирование примененных переводов
  - Сохранение изменений в TM
- **Кэширование подсказок** - для быстрого доступа к часто используемым переводам

### Система тегов для повторяющихся элементов:

#### Автоматическое определение повторяющихся элементов:
- **Анализ документа** - поиск идентичных или похожих фрагментов текста
- **Статистика повторений** - подсчет количества вхождений каждого элемента
- **Предложения тегов** - автоматическое предложение обернуть повторяющиеся элементы в теги
- **Настройка порога** - минимальное количество повторений для создания тега

#### Создание и управление тегами:
- **Автоматическое создание** - система предлагает создать теги для повторяющихся элементов
- **Ручное создание** - переводчик может вручную обернуть элементы в теги
- **Именование тегов** - понятные имена для тегов (например: `<company_name>`, `<product_name>`)
- **Редактирование тегов** - возможность изменить содержимое тега

#### Синхронный перевод тегов:
- **Единый перевод** - все экземпляры тега переводятся одинаково
- **Изменение перевода** - изменение перевода тега применяется ко всем экземплярам
- **Визуальная индикация** - теги выделяются цветом в интерфейсе
- **Статистика тегов** - отображение количества экземпляров каждого тега

#### Поддержка в Microsoft документах:
- **Word документы** - теги сохраняются как скрытый текст или специальные поля
- **Excel таблицы** - теги в ячейках синхронизируются автоматически
- **PowerPoint слайды** - теги в текстовых блоках обновляются синхронно
- **Экспорт** - теги заменяются на переведенный текст при экспорте

#### Примеры использования:
- **Названия компаний** - `<company_name>` → "ООО Ромашка"
- **Названия продуктов** - `<product_name>` → "СуперПродукт"
- **Даты и числа** - `<date>` → "15.12.2024"
- **Технические термины** - `<technical_term>` → "специализированный термин"

### Интерфейс редактора переводов:

#### Основной интерфейс (две области экрана):
- **Левая область (50%)** - исходный текст, поделенный на предложения
- **Правая область (50%)** - переводы с указанием процента совпадений
- **Разделитель** - возможность изменения пропорций областей
- **Синхронная прокрутка** - обе области прокручиваются одновременно

#### Определение предложений:
- **Любой кусок текста** считается предложением:
  - Содержимое ячейки Excel
  - Подпись к картинке
  - Заголовок слайда
  - Абзац текста
  - Элемент списка
- **Автоматическая сегментация** при импорте файлов
- **Ручная корректировка** сегментов при необходимости

#### Цветовая индикация совпадений:
- **Зеленый** - точное совпадение (100%)
- **Желтый** - частичное совпадение (75-99%)
- **Оранжевый** - похожие предложения (50-74%)
- **Белый** - нет совпадений
- **Фиолетовый** - теги (повторяющиеся элементы)
- **Процент совпадения** отображается рядом с каждым сегментом
- **Подсветка тегов** - все экземпляры тега выделяются одинаково

#### Функции применения переводов:
- **Только ручное применение** - автоматический перевод запрещен
- **"Применить сегмент"** - применение перевода для конкретного предложения
- **"Редактировать"** - возможность изменить примененный перевод
- **"Сохранить в TM"** - добавление перевода в базу данных
- **"Пропустить"** - оставить сегмент без перевода
- **"Создать тег"** - обернуть элемент в тег для синхронного перевода
- **"Редактировать тег"** - изменение перевода тега (применяется ко всем экземплярам)

#### Навигация:
- **Стрелки вверх/вниз** - переход между сегментами
- **Ctrl+Enter** - подтверждение перевода и переход к следующему
- **Tab** - переход между полями ввода
- **F2** - редактирование сегмента
- **Ctrl+T** - создание тега из выделенного текста
- **F3** - редактирование тега
- **Ctrl+G** - переход к следующему экземпляру тега

### Работа с Microsoft файлами:

#### Поддерживаемые форматы:
- **Microsoft Word (.docx)** - документы с текстом, таблицами, изображениями
- **Microsoft Excel (.xlsx)** - таблицы с формулами, графиками, диаграммами
- **Microsoft PowerPoint (.pptx)** - презентации со слайдами, анимациями, переходами

#### Импорт файлов:
- **Автоматическая сегментация** - разбивка на предложения при импорте
- **Сохранение структуры** - таблицы, списки, заголовки остаются неизменными
- **Извлечение текста** - только переводимый контент, форматирование сохраняется
- **Предупреждения** - уведомления о возможных проблемах с форматированием

#### Экспорт файлов:
- **Точное сохранение формата** - исходный файл с переведенным текстом
- **Сохранение стилей** - шрифты, цвета, размеры остаются прежними
- **Сохранение таблиц** - структура и формулы Excel не изменяются
- **Сохранение слайдов** - анимации и переходы PowerPoint остаются

#### Предупреждения для заказчика:
- **Разница в длине слов** - возможны изменения в макете из-за разной длины текста
- **Проблемы с таблицами** - переполнение ячеек при длинных переводах
- **Проблемы со слайдами** - текст может не поместиться в текстовые блоки
- **Ответственность заказчика** - подготовка документов к возможным трансформациям

### Система лицензирования:

#### Многопользовательский подход:
- **Центральный сервер лицензий** - управление всеми лицензиями
- **Пользовательские лицензии** - привязка к конкретным пользователям
- **Корпоративные лицензии** - групповые лицензии для команд
- **Онлайн проверка** - проверка через API сервер
- **Офлайн режим** - локальная проверка с кэшированием
- **Преимущества:** 
  - Централизованное управление лицензиями
  - Контроль доступа пользователей
  - Аналитика использования
  - Гибкая система тарифов

## Функциональность (базовая)

### Основные возможности Trados Studio:
1. **Translation Memory (TM)** - база данных переводов
2. **Terminology Management** - управление терминологией
3. **File Format Support** - поддержка множества форматов файлов
4. **Project Management** - управление проектами переводов
5. **Quality Assurance** - проверка качества переводов
6. **Collaboration Tools** - инструменты для совместной работы
7. **Automated Translation** - интеграция с машинным переводом
8. **Reporting** - отчеты и статистика

### Планируемая функциональность MVP:
- [ ] **Личные Translation Memory** - создание и управление персональными базами переводов
- [ ] **Обмен TM между переводчиками** - импорт/экспорт и совместное использование баз
- [ ] **Автоматическая сегментация текста** - разбивка на предложения при создании проекта
- [ ] **Умные подсказки переводов** - процент совпадений из всех доступных TM:
  - Личные базы переводчика
  - Общие базы команды/компании
  - Публичные базы (при подключении к серверам)
- [ ] **Система тегов** - для повторяющихся элементов документа:
  - Автоматическое определение повторяющихся фрагментов текста
  - Обертка повторяющихся элементов в теги
  - Синхронный перевод всех экземпляров тега
  - Поддержка HTML-подобных тегов в Microsoft документах
  - Ручное создание и управление тегами
- [ ] **Редактор переводов** - основной интерфейс для работы с текстами
- [ ] **Импорт/экспорт файлов** - поддержка Microsoft форматов:
  - Microsoft Word (.docx) - с сохранением стилей и форматирования
  - Microsoft Excel (.xlsx) - с сохранением таблиц и формул
  - Microsoft PowerPoint (.pptx) - с сохранением слайдов и анимаций
  - Сохранение исходного форматирования после перевода
  - Предупреждение о возможных изменениях из-за разницы в длине слов
- [ ] **Проекты** - создание и управление проектами переводов
- [ ] **Поиск и замена** - инструменты поиска в переводах
- [ ] **Статистика** - подсчет слов, символов и процента совпадений
- [ ] **Настройки** - конфигурация приложения и TM
- [ ] **Система лицензирования** - активация и проверка лицензий
- [ ] **Многопользовательская система** - управление пользователями и правами доступа

### Расширенная функциональность (v2.0+):
- [ ] **Терминологические базы** - управление глоссариями
- [ ] **QA проверки** - автоматическая проверка качества
- [ ] **Интеграция с MT** - машинный перевод
- [ ] **Совместная работа** - синхронизация между переводчиками
- [ ] **Расширенные форматы** - поддержка сложных форматов
- [ ] **API** - интеграция с внешними системами

## План разработки

### Этап 1: Настройка проекта (2-3 недели)
- [ ] Установка Wails CLI и настройка окружения
- [ ] Инициализация Wails проекта с Vue template
- [ ] Настройка Vue.js + TypeScript + Vite frontend
- [ ] Настройка Go модулей и зависимостей
- [ ] Настройка PostgreSQL + GORM базы данных
- [ ] Создание HTTP API сервера
- [ ] Базовая структура проекта (server + client)

### Этап 2: Базовый UI (2-3 недели)
- [ ] Главное окно приложения
- [ ] Навигация между разделами
- [ ] Базовые компоненты (кнопки, поля ввода, таблицы)
- [ ] Темы и стилизация
- [ ] Адаптивный дизайн

### Этап 3: Многопользовательская система (2-3 недели)
- [ ] Система аутентификации пользователей
- [ ] Управление пользователями и ролями
- [ ] Синхронизация данных между клиентами
- [ ] Система лицензирования
- [ ] Централизованное управление лицензиями

### Этап 4: Translation Memory система (4-5 недель)
- [ ] Создание и управление личными TM
- [ ] Система прав доступа к TM
- [ ] Обмен TM между переводчиками
- [ ] Автоматическая сегментация текста
- [ ] Система подсказок с процентами совпадений
- [ ] Кэширование подсказок для производительности
- [ ] Импорт/экспорт TM в различных форматах

### Этап 5: Редактор переводов (5-6 недель)
- [ ] Основной редактор с двумя областями экрана
- [ ] Отображение сегментов с процентами совпадений
- [ ] Подсветка совпадений (100%, 75-99%, 50-74%, теги)
- [ ] Система тегов для повторяющихся элементов:
  - Автоматическое определение повторяющихся фрагментов
  - Создание и управление тегами
  - Синхронный перевод всех экземпляров тега
  - Визуальная индикация тегов
- [ ] Применение переводов (только ручное)
- [ ] Навигация по сегментам и тегам
- [ ] Сохранение переводов в TM
- [ ] Интерфейс для редактирования переводов

### Этап 6: Управление проектами (3-4 недели)
- [ ] Создание проектов
- [ ] Импорт Microsoft файлов (Word, Excel, PowerPoint)
- [ ] Автоматическая сегментация при импорте
- [ ] Сохранение форматирования и стилей
- [ ] Управление файлами проекта
- [ ] Экспорт в исходном формате
- [ ] Предупреждения о возможных проблемах с форматированием

### Этап 7: Дополнительные функции (2-3 недели)
- [ ] Поиск и замена
- [ ] Статистика проектов
- [ ] Настройки приложения
- [ ] Справка и документация

### Этап 8: Тестирование и упаковка (2-3 недели)
- [ ] Тестирование на всех платформах
- [ ] Создание установщиков
- [ ] Оптимизация производительности
- [ ] Финальная проверка

**Общий срок разработки MVP: 6-8 месяцев**

## Статус проекта
- [x] Создание плана проекта
- [x] Выбор технологического стека (Go + Wails + Vue.js + PostgreSQL)
- [x] Анализ функциональности Trados
- [x] Проектирование многопользовательской архитектуры
- [ ] Создание MVP
- [ ] Реализация системы лицензирования
- [ ] Тестирование на всех платформах
- [ ] Подготовка к релизу

## Заметки и решения

### 2024-12-19: Добавлена система тегов для повторяющихся элементов
**Новая функция - система тегов:**
- Автоматическое определение повторяющихся фрагментов текста
- Создание HTML-подобных тегов для синхронного перевода
- Поддержка в Microsoft документах (Word, Excel, PowerPoint)
- Визуальная индикация тегов фиолетовым цветом
- Горячие клавиши для работы с тегами (Ctrl+T, F3, Ctrl+G)

**Обновлен интерфейс редактора:**
- Добавлена цветовая индикация тегов (фиолетовый)
- Функции создания и редактирования тегов
- Навигация между экземплярами тегов

**Обновлен срок разработки:** 6-8 месяцев (увеличен на 1 месяц из-за сложности системы тегов)

---
*Последнее обновление: $(date)*
